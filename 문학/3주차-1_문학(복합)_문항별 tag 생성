{"cells":[{"cell_type":"markdown","metadata":{"id":"KiOQqoaFr9xC"},"source":["# **0. íŒ¨í‚¤ì§€ ì„¤ì¹˜**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":39243,"status":"ok","timestamp":1750413226556,"user":{"displayName":"ê¹€í˜„ì£¼/ì»´í“¨í„°ê³µí•™ë¶€","userId":"13373004077348590592"},"user_tz":-540},"id":"3_3-jzXMaaaP","outputId":"1e93c3d1-c4ec-475f-b0e8-c0dca45d5312"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: langchain in /usr/local/lib/python3.11/dist-packages (0.3.25)\n","Collecting langchain-community\n","  Downloading langchain_community-0.3.25-py3-none-any.whl.metadata (2.9 kB)\n","Requirement already satisfied: langchain-core in /usr/local/lib/python3.11/dist-packages (0.3.65)\n","Requirement already satisfied: langchain-text-splitters<1.0.0,>=0.3.8 in /usr/local/lib/python3.11/dist-packages (from langchain) (0.3.8)\n","Requirement already satisfied: langsmith<0.4,>=0.1.17 in /usr/local/lib/python3.11/dist-packages (from langchain) (0.3.45)\n","Requirement already satisfied: pydantic<3.0.0,>=2.7.4 in /usr/local/lib/python3.11/dist-packages (from langchain) (2.11.7)\n","Requirement already satisfied: SQLAlchemy<3,>=1.4 in /usr/local/lib/python3.11/dist-packages (from langchain) (2.0.41)\n","Requirement already satisfied: requests<3,>=2 in /usr/local/lib/python3.11/dist-packages (from langchain) (2.32.3)\n","Requirement already satisfied: PyYAML>=5.3 in /usr/local/lib/python3.11/dist-packages (from langchain) (6.0.2)\n","Requirement already satisfied: aiohttp<4.0.0,>=3.8.3 in /usr/local/lib/python3.11/dist-packages (from langchain-community) (3.11.15)\n","Requirement already satisfied: tenacity!=8.4.0,<10,>=8.1.0 in /usr/local/lib/python3.11/dist-packages (from langchain-community) (9.1.2)\n","Collecting dataclasses-json<0.7,>=0.5.7 (from langchain-community)\n","  Downloading dataclasses_json-0.6.7-py3-none-any.whl.metadata (25 kB)\n","Collecting pydantic-settings<3.0.0,>=2.4.0 (from langchain-community)\n","  Downloading pydantic_settings-2.9.1-py3-none-any.whl.metadata (3.8 kB)\n","Collecting httpx-sse<1.0.0,>=0.4.0 (from langchain-community)\n","  Downloading httpx_sse-0.4.0-py3-none-any.whl.metadata (9.0 kB)\n","Requirement already satisfied: numpy>=1.26.2 in /usr/local/lib/python3.11/dist-packages (from langchain-community) (2.0.2)\n","Requirement already satisfied: jsonpatch<2.0,>=1.33 in /usr/local/lib/python3.11/dist-packages (from langchain-core) (1.33)\n","Requirement already satisfied: packaging<25,>=23.2 in /usr/local/lib/python3.11/dist-packages (from langchain-core) (24.2)\n","Requirement already satisfied: typing-extensions>=4.7 in /usr/local/lib/python3.11/dist-packages (from langchain-core) (4.14.0)\n","Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain-community) (2.6.1)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.11/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain-community) (1.3.2)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain-community) (25.3.0)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.11/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain-community) (1.7.0)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.11/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain-community) (6.4.4)\n","Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain-community) (0.3.2)\n","Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain-community) (1.20.1)\n","Collecting marshmallow<4.0.0,>=3.18.0 (from dataclasses-json<0.7,>=0.5.7->langchain-community)\n","  Downloading marshmallow-3.26.1-py3-none-any.whl.metadata (7.3 kB)\n","Collecting typing-inspect<1,>=0.4.0 (from dataclasses-json<0.7,>=0.5.7->langchain-community)\n","  Downloading typing_inspect-0.9.0-py3-none-any.whl.metadata (1.5 kB)\n","Requirement already satisfied: jsonpointer>=1.9 in /usr/local/lib/python3.11/dist-packages (from jsonpatch<2.0,>=1.33->langchain-core) (3.0.0)\n","Requirement already satisfied: httpx<1,>=0.23.0 in /usr/local/lib/python3.11/dist-packages (from langsmith<0.4,>=0.1.17->langchain) (0.28.1)\n","Requirement already satisfied: orjson<4.0.0,>=3.9.14 in /usr/local/lib/python3.11/dist-packages (from langsmith<0.4,>=0.1.17->langchain) (3.10.18)\n","Requirement already satisfied: requests-toolbelt<2.0.0,>=1.0.0 in /usr/local/lib/python3.11/dist-packages (from langsmith<0.4,>=0.1.17->langchain) (1.0.0)\n","Requirement already satisfied: zstandard<0.24.0,>=0.23.0 in /usr/local/lib/python3.11/dist-packages (from langsmith<0.4,>=0.1.17->langchain) (0.23.0)\n","Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/lib/python3.11/dist-packages (from pydantic<3.0.0,>=2.7.4->langchain) (0.7.0)\n","Requirement already satisfied: pydantic-core==2.33.2 in /usr/local/lib/python3.11/dist-packages (from pydantic<3.0.0,>=2.7.4->langchain) (2.33.2)\n","Requirement already satisfied: typing-inspection>=0.4.0 in /usr/local/lib/python3.11/dist-packages (from pydantic<3.0.0,>=2.7.4->langchain) (0.4.1)\n","Collecting python-dotenv>=0.21.0 (from pydantic-settings<3.0.0,>=2.4.0->langchain-community)\n","  Downloading python_dotenv-1.1.0-py3-none-any.whl.metadata (24 kB)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests<3,>=2->langchain) (3.4.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests<3,>=2->langchain) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests<3,>=2->langchain) (2.4.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests<3,>=2->langchain) (2025.6.15)\n","Requirement already satisfied: greenlet>=1 in /usr/local/lib/python3.11/dist-packages (from SQLAlchemy<3,>=1.4->langchain) (3.2.3)\n","Requirement already satisfied: anyio in /usr/local/lib/python3.11/dist-packages (from httpx<1,>=0.23.0->langsmith<0.4,>=0.1.17->langchain) (4.9.0)\n","Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.11/dist-packages (from httpx<1,>=0.23.0->langsmith<0.4,>=0.1.17->langchain) (1.0.9)\n","Requirement already satisfied: h11>=0.16 in /usr/local/lib/python3.11/dist-packages (from httpcore==1.*->httpx<1,>=0.23.0->langsmith<0.4,>=0.1.17->langchain) (0.16.0)\n","Collecting mypy-extensions>=0.3.0 (from typing-inspect<1,>=0.4.0->dataclasses-json<0.7,>=0.5.7->langchain-community)\n","  Downloading mypy_extensions-1.1.0-py3-none-any.whl.metadata (1.1 kB)\n","Requirement already satisfied: sniffio>=1.1 in /usr/local/lib/python3.11/dist-packages (from anyio->httpx<1,>=0.23.0->langsmith<0.4,>=0.1.17->langchain) (1.3.1)\n","Downloading langchain_community-0.3.25-py3-none-any.whl (2.5 MB)\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m2.5/2.5 MB\u001b[0m \u001b[31m23.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading dataclasses_json-0.6.7-py3-none-any.whl (28 kB)\n","Downloading httpx_sse-0.4.0-py3-none-any.whl (7.8 kB)\n","Downloading pydantic_settings-2.9.1-py3-none-any.whl (44 kB)\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m44.4/44.4 kB\u001b[0m \u001b[31m2.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading marshmallow-3.26.1-py3-none-any.whl (50 kB)\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m50.9/50.9 kB\u001b[0m \u001b[31m3.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading python_dotenv-1.1.0-py3-none-any.whl (20 kB)\n","Downloading typing_inspect-0.9.0-py3-none-any.whl (8.8 kB)\n","Downloading mypy_extensions-1.1.0-py3-none-any.whl (5.0 kB)\n","Installing collected packages: python-dotenv, mypy-extensions, marshmallow, httpx-sse, typing-inspect, pydantic-settings, dataclasses-json, langchain-community\n","Successfully installed dataclasses-json-0.6.7 httpx-sse-0.4.0 langchain-community-0.3.25 marshmallow-3.26.1 mypy-extensions-1.1.0 pydantic-settings-2.9.1 python-dotenv-1.1.0 typing-inspect-0.9.0\n","Collecting pytesseract\n","  Downloading pytesseract-0.3.13-py3-none-any.whl.metadata (11 kB)\n","Collecting PyPDF2\n","  Downloading pypdf2-3.0.1-py3-none-any.whl.metadata (6.8 kB)\n","Requirement already satisfied: packaging>=21.3 in /usr/local/lib/python3.11/dist-packages (from pytesseract) (24.2)\n","Requirement already satisfied: Pillow>=8.0.0 in /usr/local/lib/python3.11/dist-packages (from pytesseract) (11.2.1)\n","Downloading pytesseract-0.3.13-py3-none-any.whl (14 kB)\n","Downloading pypdf2-3.0.1-py3-none-any.whl (232 kB)\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m232.6/232.6 kB\u001b[0m \u001b[31m8.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: pytesseract, PyPDF2\n","Successfully installed PyPDF2-3.0.1 pytesseract-0.3.13\n","Collecting pdfplumber\n","  Downloading pdfplumber-0.11.7-py3-none-any.whl.metadata (42 kB)\n","\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m42.8/42.8 kB\u001b[0m \u001b[31m2.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting pdf2image\n","  Downloading pdf2image-1.17.0-py3-none-any.whl.metadata (6.2 kB)\n","Collecting pdfminer.six==20250506 (from pdfplumber)\n","  Downloading pdfminer_six-20250506-py3-none-any.whl.metadata (4.2 kB)\n","Requirement already satisfied: Pillow>=9.1 in /usr/local/lib/python3.11/dist-packages (from pdfplumber) (11.2.1)\n","Collecting pypdfium2>=4.18.0 (from pdfplumber)\n","  Downloading pypdfium2-4.30.1-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (48 kB)\n","\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m48.2/48.2 kB\u001b[0m \u001b[31m4.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: charset-normalizer>=2.0.0 in /usr/local/lib/python3.11/dist-packages (from pdfminer.six==20250506->pdfplumber) (3.4.2)\n","Requirement already satisfied: cryptography>=36.0.0 in /usr/local/lib/python3.11/dist-packages (from pdfminer.six==20250506->pdfplumber) (43.0.3)\n","Requirement already satisfied: cffi>=1.12 in /usr/local/lib/python3.11/dist-packages (from cryptography>=36.0.0->pdfminer.six==20250506->pdfplumber) (1.17.1)\n","Requirement already satisfied: pycparser in /usr/local/lib/python3.11/dist-packages (from cffi>=1.12->cryptography>=36.0.0->pdfminer.six==20250506->pdfplumber) (2.22)\n","Downloading pdfplumber-0.11.7-py3-none-any.whl (60 kB)\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m60.0/60.0 kB\u001b[0m \u001b[31m6.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pdfminer_six-20250506-py3-none-any.whl (5.6 MB)\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m5.6/5.6 MB\u001b[0m \u001b[31m66.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pdf2image-1.17.0-py3-none-any.whl (11 kB)\n","Downloading pypdfium2-4.30.1-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.9 MB)\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m2.9/2.9 MB\u001b[0m \u001b[31m78.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: pypdfium2, pdf2image, pdfminer.six, pdfplumber\n","Successfully installed pdf2image-1.17.0 pdfminer.six-20250506 pdfplumber-0.11.7 pypdfium2-4.30.1\n"]}],"source":["!pip install -U langchain langchain-community langchain-core\n","!pip install pytesseract PyPDF2\n","!pip install pdfplumber pdf2image"]},{"cell_type":"code","source":["!sudo apt-get update\n","!sudo apt-get install -y poppler-utils"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mlsx3PyNqzxw","executionInfo":{"status":"ok","timestamp":1750413244443,"user_tz":-540,"elapsed":17865,"user":{"displayName":"ê¹€í˜„ì£¼/ì»´í“¨í„°ê³µí•™ë¶€","userId":"13373004077348590592"}},"outputId":"ef2ba048-60ee-4f98-c418-f3dd8abfec7c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Get:1 https://cloud.r-project.org/bin/linux/ubuntu jammy-cran40/ InRelease [3,632 B]\n","Get:2 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64  InRelease [1,581 B]\n","Get:3 http://security.ubuntu.com/ubuntu jammy-security InRelease [129 kB]\n","Get:4 https://r2u.stat.illinois.edu/ubuntu jammy InRelease [6,555 B]\n","Get:5 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64  Packages [1,798 kB]\n","Hit:6 http://archive.ubuntu.com/ubuntu jammy InRelease\n","Get:7 http://archive.ubuntu.com/ubuntu jammy-updates InRelease [128 kB]\n","Get:8 https://r2u.stat.illinois.edu/ubuntu jammy/main all Packages [9,051 kB]\n","Get:9 https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu jammy InRelease [18.1 kB]\n","Hit:10 https://ppa.launchpadcontent.net/graphics-drivers/ppa/ubuntu jammy InRelease\n","Hit:11 https://ppa.launchpadcontent.net/ubuntugis/ppa/ubuntu jammy InRelease\n","Get:12 https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu jammy/main amd64 Packages [33.2 kB]\n","Get:13 http://archive.ubuntu.com/ubuntu jammy-backports InRelease [127 kB]\n","Get:14 http://security.ubuntu.com/ubuntu jammy-security/restricted amd64 Packages [4,532 kB]\n","Get:15 https://r2u.stat.illinois.edu/ubuntu jammy/main amd64 Packages [2,747 kB]\n","Get:16 http://security.ubuntu.com/ubuntu jammy-security/main amd64 Packages [3,024 kB]\n","Get:17 http://security.ubuntu.com/ubuntu jammy-security/universe amd64 Packages [1,253 kB]\n","Get:18 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 Packages [3,340 kB]\n","Get:19 http://archive.ubuntu.com/ubuntu jammy-updates/restricted amd64 Packages [4,703 kB]\n","Get:20 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 Packages [1,561 kB]\n","Fetched 32.5 MB in 5s (5,902 kB/s)\n","Reading package lists... Done\n","W: Skipping acquire of configured file 'main/source/Sources' as repository 'https://r2u.stat.illinois.edu/ubuntu jammy InRelease' does not seem to provide it (sources.list entry misspelt?)\n","Reading package lists... Done\n","Building dependency tree... Done\n","Reading state information... Done\n","The following NEW packages will be installed:\n","  poppler-utils\n","0 upgraded, 1 newly installed, 0 to remove and 40 not upgraded.\n","Need to get 186 kB of archives.\n","After this operation, 697 kB of additional disk space will be used.\n","Get:1 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 poppler-utils amd64 22.02.0-2ubuntu0.8 [186 kB]\n","Fetched 186 kB in 1s (195 kB/s)\n","debconf: unable to initialize frontend: Dialog\n","debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at /usr/share/perl5/Debconf/FrontEnd/Dialog.pm line 78, <> line 1.)\n","debconf: falling back to frontend: Readline\n","debconf: unable to initialize frontend: Readline\n","debconf: (This frontend requires a controlling tty.)\n","debconf: falling back to frontend: Teletype\n","dpkg-preconfigure: unable to re-open stdin: \n","Selecting previously unselected package poppler-utils.\n","(Reading database ... 126319 files and directories currently installed.)\n","Preparing to unpack .../poppler-utils_22.02.0-2ubuntu0.8_amd64.deb ...\n","Unpacking poppler-utils (22.02.0-2ubuntu0.8) ...\n","Setting up poppler-utils (22.02.0-2ubuntu0.8) ...\n","Processing triggers for man-db (2.10.2-1) ...\n"]}]},{"cell_type":"markdown","metadata":{"id":"-BC67ybd_0zG"},"source":["# **0. êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë§ˆìš´íŠ¸ & api key**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16702,"status":"ok","timestamp":1750413261164,"user":{"displayName":"ê¹€í˜„ì£¼/ì»´í“¨í„°ê³µí•™ë¶€","userId":"13373004077348590592"},"user_tz":-540},"id":"HKc9Ou1b1KcO","outputId":"b22f7df0-d08f-46ea-a7e6-f4fb14c4edeb"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"S-rAxqSqaLz1"},"outputs":[],"source":["import os\n","import openai\n","from langchain.chat_models import ChatOpenAI\n","from langchain_core.output_parsers import StrOutputParser\n","\n","#  API í‚¤ ì„¤ì •\n","OPENAI_API_KEY = \"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\"  # ì—¬ê¸°ì—ë§Œ ì…ë ¥í•˜ë©´ ì•„ë˜ì—ì„œ ìë™ ì‚¬ìš©ë¨\n","os.environ[\"OPENAI_API_KEY\"] = OPENAI_API_KEY\n","client = openai.OpenAI(api_key=OPENAI_API_KEY)"]},{"cell_type":"markdown","source":["# **1. tag ìƒì„±**"],"metadata":{"id":"UdL7ignOKzSq"}},{"cell_type":"code","source":["import json\n","import re\n","from tqdm import tqdm\n","import openai\n","\n","# âœ… í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿\n","TAG_PROMPT = \"\"\"\n","ë‹¤ìŒ ë¬¸í•™ ì§€ë¬¸ê³¼ ë¬¸ì œë¥¼ ì½ê³  ì•„ë˜ í•­ëª©ì„ JSON í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”.\n","\n","ğŸ“š ì…ë ¥ ì •ë³´\n","(ì§€ë¬¸)\n","{passage}\n","\n","(ë¬¸ì œ)\n","{question}\n","\n","ğŸ§© ë³µí•©/ë‹¨ì¼ íŒë‹¨ ê¸°ì¤€:\n","- ì§€ë¬¸ì´ 2ê°œ ì´ìƒì´ë©´ ë°˜ë“œì‹œ \"ë³µí•©\"ìœ¼ë¡œ ë¶„ë¥˜í•˜ì„¸ìš”.\n","- ë¬¸ì œì—ì„œ 'ê³µí†µì ', 'ë¹„êµ', 'ë‹¤ìŒ ê¸€ë“¤', '(ê°€)ì™€ (ë‚˜)'ë¼ëŠ” í‘œí˜„ì´ ë“±ì¥í•˜ë©´ ë°˜ë“œì‹œ \"ë³µí•©\"ìœ¼ë¡œ ë¶„ë¥˜í•˜ì„¸ìš”.\n","- ìœ„ ì¡°ê±´ ì¤‘ í•˜ë‚˜ë¼ë„ ì¶©ì¡±í•˜ë©´ ë°˜ë“œì‹œ \"ë³µí•©\"ìœ¼ë¡œ ë¶„ë¥˜í•˜ì„¸ìš”.\n","- ì§€ë¬¸ì´ 1ê°œì´ê±°ë‚˜ ì§€ë¬¸ ì—¬ëŸ¬ê°œ ì¤‘ì—ì„œ ë¬¸ì œì—ì„œ í•œ íŠ¹ì • ì§€ë¬¸ë§Œ ë¬»ëŠ” ê²½ìš°ì—ë§Œ \"ë‹¨ì¼\"ë¡œ ë¶„ë¥˜í•˜ì„¸ìš”.\n","âš ï¸ ë³µí•©/ë‹¨ì¼ ë¶„ë¥˜ëŠ” ì ˆëŒ€ í‹€ë¦¬ë©´ ì•ˆ ë©ë‹ˆë‹¤. ë°˜ë“œì‹œ ì£¼ì˜í•˜ì„¸ìš”.\n","\n","ğŸ§  ë¬¸ì œ ìœ í˜• ë¶„ë¥˜ ê¸°ì¤€ (ì§€ë¬¸ ì¥ë¥´ë³„ë¡œ ì•„ë˜ ì¤‘ í•˜ë‚˜ ì„ íƒ):\n","\n","- í˜„ëŒ€ì‹œ:\n","  - ë‚´ìš© ì´í•´: ì‹œì  ìƒí™©, ì£¼ì œ, ì •ì„œ ë° íƒœë„ ë“± íŒŒì•…\n","  - ì •ì„œ ë° íƒœë„ íŒŒì•…: í™”ìì˜ ì‹¬ë¦¬ì™€ íƒœë„ íë¦„ ì´í•´\n","  - í‘œí˜„ ë°©ì‹ ë¶„ì„: ë¹„ìœ , ìƒì§•, ë°˜ë³µ, ì„¤ì˜ ë“±\n","  - ì‹œì–´ í•´ì„: ê°œë³„ ì‹œì–´ ë˜ëŠ” í‘œí˜„ì˜ ìƒì§•/ì¤‘ì˜ì  ì˜ë¯¸ í•´ì„\n","  - ìƒì§•/ë¹„ìœ  í•´ì„: ì¤‘ì‹¬ ì´ë¯¸ì§€ë‚˜ ìƒì§• êµ¬ì¡° í•´ì„\n","\n","- ê³ ì „ ì‹œê°€:\n","  - ë‚´ìš© ì´í•´: ì „ì²´ ì˜ë¯¸, ì‘í’ˆ íë¦„, ì •ì„œ ì´í•´\n","  - ì •ì„œ íŒŒì•…: ì„ì— ëŒ€í•œ ë§ˆìŒ, ìì—°/í˜„ì‹¤ ì¸ì‹\n","  - í‘œí˜„ ê¸°ë²• ë¶„ì„: ê³ ì „ì  ìˆ˜ì‚¬ ê¸°ë²• ë¶„ì„ (ì˜íƒ„, ëŒ€ì¡°, ê³¼ì¥ ë“±)\n","  - ì„-í™”ì ê´€ê³„ ì´í•´: êµìˆ /ì„œì • ì‹œê°€ì—ì„œì˜ ê´€ê³„ ë§¥ë½\n","  - ë³€ì‹ /í™˜ìƒ í‘œí˜„ í•´ì„: ì‹ í™”/í™˜ìƒì  ìš”ì†Œ í•´ì„\n","\n","- í˜„ëŒ€ ì†Œì„¤:\n","  - ì‚¬ê±´ íë¦„ íŒŒì•…: ì¤„ê±°ë¦¬ ë° ì£¼ìš” ì‚¬ê±´ íë¦„ ì´í•´\n","  - ì¸ë¬¼ ì‹¬ë¦¬ ì´í•´: ì¸ë¬¼ì˜ ì„±ê²©, ë‚´ì  ì‹¬ë¦¬, ê´€ê³„ í•´ì„\n","  - ì‹œì  ë° ì„œìˆ  ë°©ì‹ ë¶„ì„: ì„œìˆ ì, ì‹œì , ë¬˜ì‚¬ ë°©ì‹ ë¶„ì„\n","  - ì£¼ì œ/ì‘ê°€ ì˜ë„ íŒŒì•…: ì¤‘ì‹¬ ì£¼ì œ, ì£¼ì œì˜ì‹ ë¶„ì„\n","  - ê³µê°„/ë°°ê²½ ì˜ë¯¸ ë¶„ì„: ë°°ê²½ì´ ê°€ì§€ëŠ” ìƒì§•ì  ì˜ë¯¸ í•´ì„\n","\n","- ê³ ì „ ì†Œì„¤:\n","  - ë‚´ìš© ì´í•´: ì¤„ê±°ë¦¬, ì‚¬ê±´ êµ¬ì¡° íŒŒì•…\n","  - ì¸ë¬¼ ì‹¬ë¦¬ ë° ìš´ëª… íŒŒì•…: ì£¼ìš” ì¸ë¬¼ì˜ ì„±ê²©ê³¼ ìš´ëª…\n","  - ìƒì§• ì¥ì¹˜ í•´ì„: ê¿ˆ, ì „ê¸°, ìì—° ìš”ì†Œ ë“± ìƒì§• êµ¬ì¡° í•´ì„\n","  - ê¶Œì„ ì§•ì•…ì  ê´€ì  ë¶„ì„: ì¸ê³¼ì  ì„¸ê³„ê´€, ë„ë•ì  êµí›ˆ í•´ì„\n","  - ì„œì‚¬ êµ¬ì¡° ë¶„ì„: ë„ì…-ì „ê°œ-ìœ„ê¸°-ì ˆì •-ê²°ë§ì˜ êµ¬ì¡°\n","\n","- ê·¹/ìˆ˜í•„:\n","  - ë‚´ìš© ì´í•´: ìƒí™©, ëŒ€ì‚¬, ì‚¬ê±´ì˜ íë¦„ ì´í•´\n","  - í‘œí˜„ íŠ¹ì„± ë¶„ì„: ëŒ€ì‚¬, í•´ì„¤, ì¥ë©´ êµ¬ì„±ì˜ íŠ¹ì§•\n","  - ì„œìˆ ìì˜ ê°œì… íŒŒì•…: ìˆ˜í•„/ê·¹ ì¤‘ ì„œìˆ ìì˜ ìœ„ì¹˜ ë° ì—­í• \n","  - ì£¼ì œ ë° êµí›ˆ ë„ì¶œ: ì¤‘ì‹¬ ì£¼ì œ ë° ì‚¶ì— ì£¼ëŠ” êµí›ˆ í•´ì„\n","\n","âœ’ï¸ ì§€ë¬¸ ì œëª© ë° ì‘ê°€ ì¶”ì¶œ ê¸°ì¤€:\n","- ì¼ë°˜ì ìœ¼ë¡œ ê° ì§€ë¬¸ ëì— ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ í‘œê¸°ë¨:\n","  `- ê¹€ìˆ˜ì˜ , ï½¢ê·¸ ë°©ì„ ìƒê°í•˜ë©°ï½£ -`\n","  â†’ ì‘ê°€: \"ê¹€ìˆ˜ì˜\", ì œëª©: \"ê·¸ ë°©ì„ ìƒê°í•˜ë©°\"\n","- ë³µí•© ì§€ë¬¸ì¼ ê²½ìš°:\n","  - \"ì§€ë¬¸ ì œëª©\": [\"ì œëª©1\", \"ì œëª©2\", ...]\n","  - \"ì§€ë¬¸ ì‘ê°€\": [\"ì‘ê°€1\", \"ì‘ê°€2\", ...]\n","  - ì‘ì ë¯¸ìƒì¼ ê²½ìš° \"ì‘ì ë¯¸ìƒ\"ìœ¼ë¡œ í‘œê¸°\n","\n","ğŸ“Œ ì¶œë ¥ í˜•ì‹ (ëª¨ë‘ í¬í•¨):\n","- ì¶œì²˜: ì˜ˆ) \"2022-03-êµ­ì–´_21\"\n","- ë¬¸ì œ: ë¬¸ì œ ë¬¸ì¥ ê·¸ëŒ€ë¡œ\n","- type: ë°˜ë“œì‹œ \"ë¬¸í•™\"\n","- ì§€ë¬¸ ì œëª©: ë¬¸ìì—´ ë˜ëŠ” ë¬¸ìì—´ ë¦¬ìŠ¤íŠ¸\n","- ì§€ë¬¸ ì¥ë¥´: ë¬¸ìì—´ ë˜ëŠ” ë¦¬ìŠ¤íŠ¸ (ê°ˆë˜ ë³µí•©ì´ë©´ ë¦¬ìŠ¤íŠ¸)\n","- ì§€ë¬¸ ì‘ê°€: ë¬¸ìì—´ ë˜ëŠ” ë¬¸ìì—´ ë¦¬ìŠ¤íŠ¸\n","- ë³µí•©/ë‹¨ì¼: \"ë³µí•©\" ë˜ëŠ” \"ë‹¨ì¼\"\n","- ë¬¸ì œ ìœ í˜•: ìœ„ ê¸°ì¤€ ì¤‘ ì ì ˆí•œ ê²ƒ í•˜ë‚˜\n","\n","ğŸ“Œ ì¶œë ¥ ì˜ˆì‹œ:\n","\n","[ì§€ë¬¸ 1ê°œ ì˜ˆì‹œ]\n","{{\n","  \"ì¶œì²˜\": \"2022-03-êµ­ì–´_19\",\n","  \"ë¬¸ì œ\": \"19. ã‰ ì— ëŒ€í•œ ì´í•´ë¡œ ê°€ì¥ ì ì ˆí•œ ê²ƒì€?\",\n","  \"type\": \"ë¬¸í•™\",\n","  \"ì§€ë¬¸ ì œëª©\": \"ìˆ™í–¥ì „\",\n","  \"ì§€ë¬¸ ì¥ë¥´\": \"ê³ ì „ ì†Œì„¤\",\n","  \"ì§€ë¬¸ ì‘ê°€\": \"ì‘ì ë¯¸ìƒ\",\n","  \"ë³µí•©/ë‹¨ì¼\": \"ë‹¨ì¼\",\n","  \"ë¬¸ì œ ìœ í˜•\": \"ì¸ë¬¼ ì‹¬ë¦¬ ë° ìš´ëª… íŒŒì•…\"\n","}}\n","\n","[ì§€ë¬¸ ì—¬ëŸ¬ê°œ ì˜ˆì‹œ]\n","{{\n","  \"ì¶œì²˜\": \"2022-03-êµ­ì–´_24\",\n","  \"ë¬¸ì œ\": \"24. [A]ì— ë‚˜íƒ€ë‚œ í™”ìì— ëŒ€í•œ ì´í•´ë¡œ ê°€ì¥ ì ì ˆí•œ ê²ƒì€?\",\n","  \"type\": \"ë¬¸í•™\",\n","  \"ì§€ë¬¸ ì œëª©\": [\"ë³„ì‚¬ë¯¸ì¸ê³¡\", \"ì œëª© ì—†ìŒ\", \"ë°±ìì¦ì •ë¶€ì¸ë°•ì”¨ë¬˜ì§€ëª…\"],\n","  \"ì§€ë¬¸ ì¥ë¥´\": [\"ê³ ì „ ì‹œê°€\", \"ê³ ì „ ì‹œê°€\", \"ê³ ì „ ì‚°ë¬¸\"],\n","  \"ì§€ë¬¸ ì‘ê°€\": [\"ê¹€ì¶˜íƒ\", \"ì´ì •ë³´\", \"ë°•ì§€ì›\"],\n","  \"ë³µí•©/ë‹¨ì¼\": \"ë³µí•©\",\n","  \"ë¬¸ì œ ìœ í˜•\": \"ì •ì„œ íŒŒì•…\"\n","}}\n","\n","âš ï¸ ë°˜ë“œì‹œ ìœ„ ê¸°ì¤€ì— ë”°ë¼ ìœ íš¨í•œ JSON í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”.\n","\"\"\"\n","\n","# âœ… GPT í˜¸ì¶œ í•¨ìˆ˜ (ê¸°ì¡´ê³¼ ë™ì¼)\n","def generate_tag(passage, question, source, passage_code):\n","    prompt = TAG_PROMPT.format(passage=passage, question=question)\n","    try:\n","        resp = client.chat.completions.create(\n","            model=\"gpt-4o-mini\",\n","            temperature=0.7,\n","            max_tokens=1500,\n","            messages=[\n","                {\"role\": \"system\", \"content\": \"ë‹¹ì‹ ì€ ìˆ˜ëŠ¥ êµ­ì–´ ë¬¸í•™ ë¬¸ì œ íƒœê¹… ì „ë¬¸ê°€ì…ë‹ˆë‹¤. JSONë§Œ ì¶œë ¥í•˜ì„¸ìš”. 'ì§€ë¬¸' í•„ë“œëŠ” ì ˆëŒ€ ì‘ì„±í•˜ì§€ ë§ˆì„¸ìš”.\"},\n","                {\"role\": \"user\", \"content\": prompt}\n","            ]\n","        )\n","        text = resp.choices[0].message.content.strip()\n","        try:\n","            tag = json.loads(text)\n","        except json.JSONDecodeError:\n","            print(f\"âŒ JSON íŒŒì‹± ì‹¤íŒ¨: {text}\")\n","            return {\"ì¶œì²˜\": source, \"ì˜¤ë¥˜\": \"JSON íŒŒì‹± ì‹¤íŒ¨\"}\n","        tag[\"ì¶œì²˜\"] = source\n","        tag[\"ì§€ë¬¸\"] = passage_code  # âœ… ì—¬ê¸°ì„œ ë°˜ë“œì‹œ ì½”ë“œë¡œ ë®ì–´ì“°ê¸°\n","        return tag\n","    except Exception as e:\n","        print(f\"âŒ GPT ìš”ì²­ ì˜¤ë¥˜: {e}\")\n","        return {\"ì¶œì²˜\": source, \"ì˜¤ë¥˜\": str(e)}\n","\n","# âœ… ì§€ë¬¸-ë¬¸ì œ íŒŒì„œ ê°œì„ \n","def parse_literature_file(filepath):\n","    with open(filepath, 'r', encoding='utf-8') as f:\n","        lines = f.readlines()\n","\n","    entries = []\n","    passage = None\n","    passage_code = None\n","    question_code = None\n","    question_buf = []\n","\n","    # ì§€ë¬¸/ë¬¸ì œ í—¤ë” ì •ê·œì‹\n","    passage_header = re.compile(r'^---\\s+(?P<code>[^_]+_p\\d+_\\d+~\\d+)')\n","    question_header = re.compile(r'^---\\s+(?P<code>[^_]+_\\d{1,2})')\n","\n","    for line in lines:\n","        line_strip = line.strip()\n","\n","        # ì§€ë¬¸ ì‹œì‘\n","        m_pass = passage_header.match(line_strip)\n","        if m_pass:\n","            # ì €ì¥\n","            if question_code:\n","                entries.append({\n","                    'passage_code': passage_code,\n","                    'passage': passage.strip(),\n","                    'question_code': question_code,\n","                    'question': '\\n'.join(question_buf).strip()\n","                })\n","            # ì´ˆê¸°í™”\n","            passage_code = m_pass.group('code')\n","            passage = ''\n","            question_code = None\n","            question_buf = []\n","            mode = 'passage'\n","            continue\n","\n","        # ë¬¸ì œ ì‹œì‘\n","        m_q = question_header.match(line_strip)\n","        if m_q:\n","            if question_code:\n","                # ì´ì „ ë¬¸ì œ ì €ì¥\n","                entries.append({\n","                    'passage_code': passage_code,\n","                    'passage': passage.strip(),\n","                    'question_code': question_code,\n","                    'question': '\\n'.join(question_buf).strip()\n","                })\n","            question_code = m_q.group('code')\n","            question_buf = []\n","            mode = 'question'\n","            continue\n","\n","        if mode == 'passage':\n","            passage += line\n","        elif mode == 'question':\n","            question_buf.append(line_strip)\n","\n","    # ë§ˆì§€ë§‰ ë¬¸ì œ ì €ì¥\n","    if question_code:\n","        entries.append({\n","            'passage_code': passage_code,\n","            'passage': passage.strip(),\n","            'question_code': question_code,\n","            'question': '\\n'.join(question_buf).strip()\n","        })\n","\n","    return entries\n","\n","# âœ… íƒœê¹… ì‹¤í–‰ í•¨ìˆ˜\n","def run_tagging(input_path, output_path):\n","    data = parse_literature_file(input_path)\n","    results = []\n","    for item in tqdm(data):\n","        src = f\"{item['passage_code']}_{item['question_code']}\"\n","        tag = generate_tag(item['passage'], item['question'], src, item['passage_code'])\n","        results.append(tag)\n","    with open(output_path, 'w', encoding='utf-8') as f:\n","        json.dump(results, f, ensure_ascii=False, indent=2)\n","    print(f\"âœ… ì™„ë£Œ: {output_path}\")\n","\n","# âœ… ì‹¤í–‰\n","input_path = '/content/drive/MyDrive/Colab Notebooks/TAVE í”„ë¡œì íŠ¸_STUBO/ë¬¸í•™/data/literature_only.txt'\n","output_path = '/content/drive/MyDrive/Colab Notebooks/TAVE í”„ë¡œì íŠ¸_STUBO/ë¬¸í•™/data/literature_tagged.json'\n","\n","run_tagging(input_path, output_path)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Ee--3uIOD8ko","executionInfo":{"status":"ok","timestamp":1750413870613,"user_tz":-540,"elapsed":605977,"user":{"displayName":"ê¹€í˜„ì£¼/ì»´í“¨í„°ê³µí•™ë¶€","userId":"13373004077348590592"}},"outputId":"417acd30-abd6-403e-e113-8156ab0b4f93"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 238/238 [10:03<00:00,  2.53s/it]"]},{"output_type":"stream","name":"stdout","text":["âœ… ì™„ë£Œ: /content/drive/MyDrive/Colab Notebooks/TAVE í”„ë¡œì íŠ¸_STUBO/ë¬¸í•™/data/literature_tagged.json\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}]}],"metadata":{"colab":{"collapsed_sections":["KiOQqoaFr9xC"],"provenance":[],"authorship_tag":"ABX9TyPREMmuE6HVVaeFIBREyFdW"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}